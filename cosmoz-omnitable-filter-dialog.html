<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../cosmoz-dialog/cosmoz-dialog-behavior.html">
<dom-module id="cosmoz-omnitable-filter-dialog">
    <template>
            <style include="paper-dialog-shared-styles"></style>
        <style>
            :host {
                padding: 12px;
            }
        </style>
            <h2>Filter</h2>
            <div id="filters"></div>
    </template>
    <script>
    (() => {
    	'use strict';
    	Polymer({
    		is: 'cosmoz-omnitable-filter-dialog',
    
    		behaviors: [
    			Polymer.PaperDialogBehavior,
    		],

    		properties: {
    			columns: {
    				type: Array
    			}
    		},

    		observers: [
    			'_columnsChanged(columns.*)'
    		],

    		_columnsChanged(columnsChange) {
    			const columns = columnsChange.base,
    				filters = this.$.filters;

    			if (!columns) {
    				return;
    			}
    
    			filters.innerHTML = '';
    
    			columns.forEach(c => {
    				const instance = c.headerTemplatizer.getInstance();
    				if (!instance) {
    					return;
    				}
    				if (instance._flushProperties) {
    					instance._flushProperties(true);
    				}
    				Polymer.dom(this.$.filters).appendChild(instance.root);
    			});
    		}
    	});
    })();
    </script>
</dom-module>
