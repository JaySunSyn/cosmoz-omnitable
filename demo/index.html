<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Cosmoz Omnitable</title>

	<script src="../../webcomponentsjs/webcomponents-lite.js"></script>
	<link rel="import" href="../cosmoz-omnitable.html">
	<link rel="import" href="../../iron-flex-layout/iron-flex-layout.html">
	<link rel="import" href="../../iron-flex-layout/classes/iron-flex-layout.html">
	<link rel="import" href="../../paper-button/paper-button.html">
	<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
	<link rel="import" href="../../paper-menu/paper-menu.html">
	<link rel="import" href="../../paper-item/paper-item.html">
	<link rel="import" href="../../cosmoz-i18next/cosmoz-i18next.html">

</head>
<body class="fullbleed">
	<dom-module id="x-page">
		<template>
<!-- 			<cosmoz-i18next interpolation-prefix="$" interpolation-suffix="$" id="translations"></cosmoz-i18next>
 -->
			<div class="layout vertical fit">
				<h3>Cosmoz omnitable demo</h3>
				<div>
					<paper-dropdown-menu label="Language">
						<paper-menu class="dropdown-content" attr-for-selected="data-language" selected="{{language}}">
							<paper-item data-language="fr">French</paper-item>
							<paper-item data-language="en">English</paper-item>
						</paper-menu>
					</paper-dropdown-menu>
				</div>
				<cosmoz-omnitable data="{{ data }}" class="flex" selection-enabled group-on="{{group}}">
					<header id="id">Id</header>
					<header id="name">Name</header>
					<header id="date" type="date">Date</header>
					<header id="group">Group</header>
					<!-- <header id="amount">{{ _('Amount') }}</header> -->
					<button action on-run="runAction">Hello</button>
				</cosmoz-omnitable>
			</div>
		</template>
	</dom-module>

	<template is="dom-bind" id="t">
		<x-page id="page"></x-page>
	</template>

	<script type="text/javascript">
/*global document, window, Cosmoz */
(function () {
	"use strict";
	window.addEventListener('WebComponentsReady', function () {
		var
			data = [],
			i,
			j,
			n = 0,
			itemsCount,
			group,
			t = document.getElementById('t'),
			page = document.getElementById('page');

		for (i = 0; i < 30; i += 1) {
			group =  'Group ' + i;
			itemsCount = i * 2  + 1;
			for (j = 0; j < itemsCount; j+= 1) {
				data.push({
					id: n,
					name: group + ' item ' + j,
					value: 0,
					date: '2015-' + (i % 12 + 1) + '-' + (j % 28 + 1),
					group: group

				});
				n += 1;
			}
		}

		Polymer({
			is: 'x-page',
			properties: {
				language: {
					type: String,
					value: 'fr',
					observer: '_languageChanged'
				},
				group: {
					type: String
				}
			},
			_languageChanged: function () {
				if (this.allTranslations) {
					this.translations = this.allTranslations[this.language];
				}
			},
			ready: function () {
				this.allTranslations = {
					fr: {
						'Group on': 'Regrouper par'
					},
					en: {
						'Group on': 'Group on'
					}

				};
				if (this.language) {
					this.translations = this.allTranslations[this.language];
				}
				this.data = data;
			},
			runAction: function (event, detail) {
				console.log('runAction', event, detail, detail.items);
			}
		});

	});
}());
	</script>
</body>
</html>